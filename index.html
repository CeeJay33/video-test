<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no, maximum-scale=1">
    <title>HELPARR Video Feed</title>
    <style>
        :root {
            --safe-area-inset-top: 0;
            --safe-area-inset-bottom: 0;
            --safe-area-inset-left: 0;
            --safe-area-inset-right: 0;
        }

        @supports (padding: max(0px)) {
            :root {
                --safe-area-inset-top: env(safe-area-inset-top);
                --safe-area-inset-bottom: env(safe-area-inset-bottom);
                --safe-area-inset-left: env(safe-area-inset-left);
                --safe-area-inset-right: env(safe-area-inset-right);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            height: 100vh;
            height: 100dvh;
            overflow: hidden;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        .videos-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            height: 100dvh;
            overflow-y: scroll;
            overflow-x: hidden;
            scroll-snap-type: y mandatory;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
            padding-bottom: 0;
            position: relative;
        }

        /* Responsive widths */
        @media (max-width: 480px) {
            .videos-container {
                width: 100%;
                max-width: 100%;
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .videos-container {
                width: 100%;
                max-width: 600px;
                margin: 0 auto;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .videos-container {
                width: 100%;
                max-width: 650px;
                margin: 0 auto;
            }
        }

        @media (min-width: 1025px) and (max-width: 1440px) {
            .videos-container {
                width: 500px;
                height: 100vh;
                height: 100dvh;
            }
        }

        @media (min-width: 1441px) {
            .videos-container {
                width: 550px;
                height: 100vh;
                height: 100dvh;
            }
        }

        .videos-container::-webkit-scrollbar {
            width: 0;
            display: none;
        }

        .video-feed-container {
            width: 100%;
            height: 100vh;
            height: 100dvh;
            background: #000;
            position: relative;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            -webkit-appearance: none;
            appearance: none;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* Hide default iOS controls */
        video::-webkit-media-controls {
            display: none !important;
        }

        video::-webkit-media-controls-panel {
            display: none !important;
        }

        video::-webkit-media-controls-play-button {
            display: none !important;
        }

        video::-webkit-media-controls-timeline {
            display: none !important;
        }

        /* Loading indicator */
        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 23;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .loading-indicator.visible {
            opacity: 1;
            visibility: visible;
        }

        .spinner-ring {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tap to show controls overlay */
        .tap-zone {
            position: absolute;
            inset: 0;
            z-index: 24;
            cursor: pointer;
            -webkit-touch-callout: none;
        }

        /* Header Overlay - Always Visible */
        .header-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 20;
            padding: 1rem;
            padding-top: max(1rem, calc(var(--safe-area-inset-top) + 0.5rem));
            padding-left: max(1rem, calc(var(--safe-area-inset-left) + 0.5rem));
            padding-right: max(1rem, calc(var(--safe-area-inset-right) + 0.5rem));
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7), transparent);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            opacity: 1;
        }

        .header-overlay.hidden {
            opacity: 1;
            pointer-events: none;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            flex-shrink: 0;
        }

        .creator-info {
            flex: 1;
            min-width: 0;
        }

        .creator-name {
            font-weight: 600;
            color: #fff;
            font-size: 0.875rem;
            line-height: 1.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .creator-time {
            font-size: 0.75rem;
            color: #d1d5db;
            line-height: 1rem;
        }

        /* Responsive header for small screens */
        @media (max-width: 360px) {
            .header-overlay {
                padding: 0.5rem;
                gap: 0.5rem;
            }

            .avatar {
                width: 32px;
                height: 32px;
            }

            .creator-name {
                font-size: 0.8rem;
            }

            .creator-time {
                font-size: 0.65rem;
            }
        }

        /* iPhone 12 Pro Max and large screens */
        @media (min-width: 1025px) {
            .header-overlay {
                padding: 1.5rem;
            }

            .avatar {
                width: 45px;
                height: 45px;
            }

            .creator-name {
                font-size: 0.95rem;
            }
        }

        /* Engagement Overlay - Always Visible */
        .engagement-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            pointer-events: none;
            padding: 1.5rem;
            padding-top: max(1.5rem, calc(var(--safe-area-inset-top) + 1rem));
            padding-bottom: max(1.5rem, calc(var(--safe-area-inset-bottom) + 1rem));
            padding-left: max(1.5rem, calc(var(--safe-area-inset-left) + 1rem));
            padding-right: max(1.5rem, calc(var(--safe-area-inset-right) + 1rem));
            z-index: 15;
            opacity: 1;
        }

        .engagement-overlay.hidden {
            opacity: 1;
            pointer-events: none;
        }

        .top-right-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: flex-end;
            pointer-events: auto;
        }

        .views-badge {
            display: flex;
            justify-content: flex-end;
            pointer-events: auto;
        }

        .badge {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            pointer-events: auto;
        }

        .badge svg {
            width: 1rem;
            height: 1rem;
            color: #fff;
        }

        .badge-text {
            color: #fff;
            font-size: 0.875rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .mute-button-wrapper {
            display: flex;
            gap: 0.5rem;
            pointer-events: auto;
        }

        .mute-btn-small {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            border: none;
            color: #fff;
            width: 44px;
            height: 44px;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.2s ease;
            font-family: inherit;
            -webkit-tap-highlight-color: transparent;
            pointer-events: auto;
        }

        .mute-btn-small:hover {
            background: rgba(0, 0, 0, 0.75);
        }

        .mute-btn-small:active {
            transform: scale(0.95);
        }

        .mute-btn-small svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        .engagement-buttons {
            display: flex;
            align-items: flex-end;
            gap: 1rem;
            pointer-events: auto;
            flex-direction: column;
            margin-right: 0;
            margin-bottom: 7rem;
        }

        .engagement-btn {
            background: transparent;
            border: none;
            color: #fff;
            padding: 0.5rem 0.75rem;
            border-radius: 9999px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.2s ease;
            font-family: inherit;
            min-width: auto;
            -webkit-tap-highlight-color: transparent;
        }

        .engagement-btn:hover {
            background: rgba(0, 0, 0, 0.75);
        }

        .engagement-btn:active {
            transform: scale(0.95);
        }

    

        .like-icon {
            color: #ef4444;
        }

        /* Responsive engagement for small screens */
        @media (max-width: 360px) {
            .engagement-overlay {
                padding: 0.75rem;
                padding-top: max(0.75rem, calc(var(--safe-area-inset-top) + 0.5rem));
                padding-bottom: max(0.75rem, calc(var(--safe-area-inset-bottom) + 0.5rem));
                padding-left: max(0.75rem, calc(var(--safe-area-inset-left) + 0.5rem));
                padding-right: max(0.75rem, calc(var(--safe-area-inset-right) + 0.5rem));
            }

            .top-right-section {
                gap: 0.75rem;
            }

            .badge {
                padding: 0.3rem 0.6rem;
            }

            .badge svg {
                width: 0.8rem;
                height: 0.8rem;
            }

            .badge-text {
                font-size: 0.7rem;
            }

            .mute-btn-small {
                width: 40px;
                height: 40px;
            }

            .mute-btn-small svg {
                width: 1.1rem;
                height: 1.1rem;
            }

            .engagement-buttons {
                gap: 0.6rem;
                margin-bottom: 5.5rem;
            }

            .engagement-btn {
                padding: 0.4rem;
                font-size: 0.6rem;
            }

            .engagement-btn svg {
                width: 1.2rem;
                height: 1.2rem;
            }
        }

        /* Tablet responsive */
        @media (min-width: 481px) and (max-width: 768px) {
            .engagement-overlay {
                padding: 2rem;
            }

            .top-right-section {
                gap: 1.2rem;
            }

            .badge {
                padding: 0.4rem 0.8rem;
            }

            .badge-text {
                font-size: 0.9rem;
            }

            .engagement-buttons {
                gap: 1.2rem;
                margin-bottom: 6.5rem;
            }

            .engagement-btn {
                padding: 0.6rem 0.9rem;
                font-size: 0.8rem;
            }

            .engagement-btn svg {
                width: 1.6rem;
                height: 1.6rem;
            }
        }

        /* Desktop responsive */
        @media (min-width: 1025px) {
            .engagement-overlay {
                padding: 2rem;
            }

            .top-right-section {
                gap: 1.2rem;
            }

            .engagement-buttons {
                gap: 1.2rem;
                margin-bottom: 7rem;
            }

            .engagement-btn {
                padding: 0.6rem 0.9rem;
                font-size: 0.8rem;
            }

            .engagement-btn svg {
                width: 1.8rem;
                height: 1.8rem;
            }
        }

        /* iPhone 12 Pro Max specific */
        @media (min-width: 428px) and (max-height: 926px) and (max-width: 430px) {
            .engagement-overlay {
                padding-bottom: max(1.5rem, calc(var(--safe-area-inset-bottom) + 1.5rem));
            }

            .engagement-buttons {
                margin-bottom: 6.5rem;
            }
        }

        /* Play Button Overlay - Center of screen */
        .play-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
            z-index: 25;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .play-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .play-button {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            border: none;
            padding: 1.5rem;
            border-radius: 9999px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        .play-button:hover {
            background: rgba(0, 0, 0, 0.75);
        }

        .play-button:active {
            transform: scale(0.95);
        }

        .play-button svg {
            width: 3rem;
            height: 3rem;
            color: #fff;
            fill: #fff;
        }

        /* Close Button */
        .close-btn {
            position: fixed;
            top: 2.5rem;
            left: 0.8rem;
            z-index: 100;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            border: none;
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .close-btn:hover {
            background: rgba(0, 0, 0, 0.8);
            transform: scale(1.1);
        }

        .close-btn:active {
            transform: scale(0.95);
        }

        .close-btn svg {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 2.5;
            stroke: #999;
        }

        @media (min-width: 1025px) {
            .close-btn {
                top: 1.5rem;
                left: 1.5rem;
            }
        }

        .controls-overlay {
            position: absolute;
            bottom: 5rem;
            left: 0;
            right: 0;
            padding: 1rem;
            z-index: 30;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, bottom 0.3s ease;
            pointer-events: none;
        }

        .controls-overlay.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        .progress-container {
            display: none;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .progress-bar {
            flex: 1;
            height: 0.25rem;
            background: rgba(107, 114, 128, 0.8);
            border-radius: 9999px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: height 0.2s ease;
            -webkit-touch-callout: none;
        }

        .progress-bar:hover {
            height: 0.375rem;
        }

        .progress-bar:active {
            height: 0.375rem;
        }

        .progress-fill {
            height: 100%;
            background: #ef4444;
            border-radius: 9999px;
            width: 0%;
            position: relative;
            transition: width 0.1s linear;
        }

        .progress-thumb {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 1rem;
            height: 1rem;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .progress-bar:hover .progress-thumb,
        .progress-bar:active .progress-thumb {
            opacity: 1;
        }

        .time-display {
            color: #fff;
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .control-buttons {
            display: none;
        }

        .control-btn {
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            transition: color 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        .control-btn:hover {
            color: #d1d5db;
        }

        .control-btn:active {
            color: #d1d5db;
        }

        .control-btn svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 50;
            padding: 0;
        }

        /* Progress Bar - Bottom (shows when nav is hidden) */
        .progress-bar-nav-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 3px;
            background: rgba(107, 114, 128, 0.8);
            border-radius: 0;
            cursor: pointer;
            overflow: hidden;
            -webkit-touch-callout: none;
            z-index: 51;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .progress-bar-nav-bottom.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* Progress Bar - Top (shows inside nav top border when visible) */
        .progress-bar-nav-top {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(107, 114, 128, 0.8);
            cursor: pointer;
            overflow: hidden;
            -webkit-touch-callout: none;
            z-index: 100;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .progress-bar-nav-top.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .progress-fill-nav {
            height: 100%;
            background: #ef4444;
            width: 0%;
            position: relative;
            transition: width 0.1s linear;
        }

        .nav-content {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 15, 15, 0.85);
            backdrop-filter: blur(12px);
            padding: 0.75rem 0;
            padding-bottom: max(0.75rem, var(--safe-area-inset-bottom));
            z-index: 49;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .nav-content.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 550px;
            margin: 0 auto;
            padding: 0 1rem;
            gap: 0.5rem;
        }

        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.4rem;
            text-decoration: none;
            color: #6b6d6e;
            transition: all 0.2s ease;
            padding: 0.5rem;
            border-radius: 8px;
            -webkit-tap-highlight-color: transparent;
            flex: 1;
            min-width: 0;
            max-width: 80px;
        }

        .bottom-nav-item:hover {
            color: #999;
        }

        .bottom-nav-item.active {
            color: #3b82f6;
        }

        .bottom-nav-item.active svg {
            stroke: #3b82f6 !important;
            color: #3b82f6 !important;
            fill: #3b82f6 !important;
        }

        .bottom-nav-item svg {
            width: 28px;
            height: 28px;
            stroke: currentColor;
            fill: currentColor;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .nav-text {
            font-size: 0.65rem;
            font-weight: 500;
            text-transform: capitalize;
            text-align: center;
            line-height: 1;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .nav-text small {
            display: block;
        }

        /* Responsive nav for small screens */
        @media (max-width: 360px) {
            .nav-content {
                padding: 0.5rem 0;
                padding-bottom: max(0.5rem, var(--safe-area-inset-bottom));
            }

            .nav-items {
                padding: 0 0.5rem;
                gap: 0.25rem;
            }

            .bottom-nav-item {
                max-width: 70px;
                gap: 0.3rem;
                padding: 0.3rem;
            }

            .bottom-nav-item svg {
                width: 24px;
                height: 24px;
            }

            .nav-text {
                font-size: 0.6rem;
            }
        }

        /* Responsive nav for medium screens */
        @media (min-width: 481px) and (max-width: 768px) {
            .nav-items {
                padding: 0 1.5rem;
                gap: 1rem;
            }

            .bottom-nav-item {
                max-width: 100px;
                gap: 0.5rem;
            }

            .bottom-nav-item svg {
                width: 32px;
                height: 32px;
            }

            .nav-text {
                font-size: 0.7rem;
            }
        }

        /* Desktop responsive */
        @media (min-width: 1025px) {
            .nav-items {
                padding: 0 2rem;
                gap: 1.5rem;
            }

            .bottom-nav-item {
                max-width: 120px;
                gap: 0.5rem;
            }

            .bottom-nav-item svg {
                width: 32px;
                height: 32px;
            }

            .nav-text {
                font-size: 0.75rem;
            }
        }

        /* iPhone 12 Pro Max specific */
        @media (min-width: 428px) and (max-height: 926px) and (max-width: 430px) {
            .nav-content {
                padding-bottom: max(0.75rem, calc(var(--safe-area-inset-bottom) + 0.5rem));
            }
        }

        /* Loading State */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            height: 100dvh;
            color: #fff;
            font-size: 1.2rem;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        .error {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            height: 100dvh;
            color: #ef4444;
            font-size: 1.2rem;
            text-align: center;
            padding: 2rem;
        }

        @media (max-width: 768px) {
            .header-overlay {
                padding: 0.75rem;
            }

            .avatar {
                width: 35px;
                height: 35px;
            }

            .creator-name {
                font-size: 0.8rem;
            }

            .creator-time {
                font-size: 0.7rem;
            }

            .engagement-overlay {
                padding: 1rem;
            }

            .badge {
                padding: 0.3rem 0.6rem;
            }

            .badge svg {
                width: 0.9rem;
                height: 0.9rem;
            }

            .badge-text {
                font-size: 0.8rem;
            }

            .engagement-buttons {
                gap: 0.8rem;
                margin-bottom: 6rem;
            }

            .engagement-btn {
                padding: 0.5rem;
                font-size: 0.7rem;
            }

            .engagement-btn svg {
                width: 1.3rem;
                height: 1.3rem;
            }

            .time-display {
                font-size: 0.7rem;
            }

            .progress-bar {
                height: 0.2rem;
            }

            .progress-bar:hover,
            .progress-bar:active {
                height: 0.3rem;
            }

            .control-btn svg {
                width: 1.1rem;
                height: 1.1rem;
            }

            .play-button {
                padding: 1.2rem;
            }

            .play-button svg {
                width: 2.5rem;
                height: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .header-overlay {
                padding: 0.5rem;
            }

            .avatar {
                width: 30px;
                height: 30px;
            }

            .creator-name {
                font-size: 0.75rem;
            }

            .creator-time {
                font-size: 0.65rem;
            }

            .engagement-overlay {
                padding: 0.75rem;
            }

            .engagement-buttons {
                gap: 0.6rem;
                margin-bottom: 5.5rem;
            }

            .engagement-btn {
                padding: 0.4rem;
                font-size: 0.6rem;
            }

            .engagement-btn svg {
                width: 1.7rem;
                height: 1.7rem;
            }

            .badge {
                padding: 0.25rem 0.5rem;
            }

            .badge-text {
                font-size: 0.7rem;
            }

            .badge svg {
                width: 0.8rem;
                height: 0.8rem;
            }

            .time-display {
                font-size: 0.65rem;
            }

            .control-btn svg {
                width: 1rem;
                height: 1rem;
            }

            .play-button {
                padding: 1rem;
            }

            .play-button svg {
                width: 2rem;
                height: 2rem;
            }

            .controls-overlay {
                padding: 0.75rem;
                bottom: 4.5rem;
            }

            .progress-container {
                gap: 0.4rem;
                margin-bottom: 0.4rem;
            }

            .nav-text {
                font-size: 0.6rem;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .header-overlay {
                padding: 1.5rem;
            }

            .engagement-overlay {
                padding: 2rem;
            }

            .engagement-buttons {
                gap: 1.2rem;
            }

            .engagement-btn {
                padding: 0.6rem 0.9rem;
                font-size: 0.8rem;
            }
        }

        @media (min-width: 1025px) {
            .header-overlay {
                padding: 1.5rem;
            }

            .engagement-overlay {
                padding: 2rem;
            }

            .engagement-buttons {
                gap: 1.2rem;
                margin-bottom: 7rem;
            }

            .engagement-btn {
                padding: 0.6rem 0.9rem;
                font-size: 0.8rem;
            }

            .play-button {
                padding: 2rem;
            }

            .play-button svg {
                width: 3.5rem;
                height: 3.5rem;
            }

            .controls-overlay {
                bottom: 6rem;
            }
        }

        @media (min-width: 1440px) {
            .engagement-btn {
                padding: 0.7rem 1rem;
                font-size: 0.9rem;
            }

            .engagement-btn svg {
                width: 1.8rem;
                height: 1.8rem;
            }
        }

        /* Extra comprehensive responsive styles */
        
        /* Play button responsive */
        @media (max-width: 360px) {
            .play-button {
                padding: 1rem;
            }

            .play-button svg {
                width: 2rem;
                height: 2rem;
            }
        }

        @media (min-width: 361px) and (max-width: 480px) {
            .play-button {
                padding: 1.2rem;
            }

            .play-button svg {
                width: 2.5rem;
                height: 2.5rem;
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .play-button {
                padding: 1.5rem;
            }

            .play-button svg {
                width: 3rem;
                height: 3rem;
            }
        }

        /* Controls responsive */
        @media (max-width: 360px) {
            .controls-overlay {
                padding: 0.75rem;
                bottom: 4.5rem;
            }

            .progress-container {
                gap: 0.4rem;
                margin-bottom: 0.4rem;
            }

            .time-display {
                font-size: 0.65rem;
            }
        }

        @media (min-width: 361px) and (max-width: 480px) {
            .controls-overlay {
                padding: 0.75rem;
                bottom: 5rem;
            }

            .progress-container {
                gap: 0.4rem;
                margin-bottom: 0.4rem;
            }

            .time-display {
                font-size: 0.7rem;
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .controls-overlay {
                padding: 1rem;
                bottom: 5.5rem;
            }

            .progress-container {
                gap: 0.5rem;
                margin-bottom: 0.5rem;
            }

            .time-display {
                font-size: 0.8rem;
            }
        }

        /* Loading and error states */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            height: 100dvh;
            color: #fff;
            font-size: 1.2rem;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        .error {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            height: 100dvh;
            color: #ef4444;
            font-size: 1.2rem;
            text-align: center;
            padding: 2rem;
        }

        /* Prevent zoom on input focus */
        @media (max-width: 1024px) {
            input,
            select,
            textarea,
            button {
                font-size: 16px !important;
            }
        }

        /* Prevent double tap zoom */
        input,
        button {
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        /* Tap zone */
        .tap-zone {
            position: absolute;
            inset: 0;
            z-index: 24;
            cursor: pointer;
            -webkit-touch-callout: none;
        }

        /* Loading indicator */
        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 23;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .loading-indicator.visible {
            opacity: 1;
            visibility: visible;
        }

        .spinner-ring {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            background: rgba(0, 0, 0, 0.3);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* iPhone notch and safe area support */
        @supports (padding: max(0px)) {
            body {
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
        }

        /* Prevent unwanted zoom behavior */
        html {
            touch-action: manipulation;
        }

        /* Smooth scrolling */
        .videos-container {
            scroll-behavior: smooth;
        }

        /* Fix for notches on modern phones */
        @media (max-height: 600px) {
            .engagement-buttons {
                margin-bottom: 5rem !important;
            }
        }

        /* Landscape mode adjustments */
        @media (max-height: 500px) {
            .header-overlay {
                padding: 0.5rem !important;
            }

            .avatar {
                width: 30px !important;
                height: 30px !important;
            }

            .engagement-buttons {
                margin-bottom: 4rem !important;
                gap: 0.5rem !important;
            }

            .engagement-btn {
                padding: 0.3rem !important;
                font-size: 0.6rem !important;
            }

            .engagement-btn svg {
                width: 1rem !important;
                height: 1rem !important;
            }
        }

        /* Ultra-wide screens */
        @media (min-width: 1920px) {
            .videos-container {
                width: 600px;
            }

            .nav-items {
                gap: 2rem;
            }

            .bottom-nav-item svg {
                width: 36px;
                height: 36px;
            }

            .nav-text {
                font-size: 0.8rem;
            }
        }

        /* Prevent layout shift when scrollbar appears */
        html {
            overflow-y: scroll;
        }
    </style>
</head>
<body>
    <!-- Close/Back Button -->
    <button class="close-btn" id="closeBtn" title="Go back">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
    </button>

    <!-- Videos Container -->
    <div class="videos-container" id="videosContainer">
        <!-- Loading State -->
        <div class="loading">
            <div class="spinner"></div>
        </div>
    </div>

    <!-- Progress Bar - Bottom (shows when nav hidden) -->
    <div class="progress-bar-nav-bottom" id="progressBarBottom">
        <div class="progress-fill-nav" id="navProgressFillBottom"></div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav" id="bottomNav">
        <!-- Navigation Items - Hides after 2 seconds -->
        <div class="nav-content" id="navContent">
            <!-- Progress Bar at top of nav - shows when nav visible -->
            <div class="progress-bar-nav-top" id="progressBarTop">
                <div class="progress-fill-nav" id="navProgressFillTop"></div>
            </div>

            <div class="nav-items">
                <a href="#" class="bottom-nav-item">
                    <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.30681 1.24996C6.50585 1.24969 5.95624 1.24951 5.46776 1.38342C4.44215 1.66458 3.58414 2.36798 3.1073 3.31853C2.88019 3.77127 2.77258 4.31024 2.61576 5.0957L1.99616 8.19383C1.76456 9.35186 2.08191 10.4718 2.74977 11.3115L2.74977 14.0564C2.74975 15.8942 2.74974 17.3498 2.9029 18.489C3.06053 19.6614 3.39265 20.6104 4.14101 21.3587C4.88937 22.1071 5.83832 22.4392 7.01074 22.5969C8.14996 22.75 9.60559 22.75 11.4434 22.75H12.5562C14.3939 22.75 15.8496 22.75 16.9888 22.5969C18.1612 22.4392 19.1102 22.1071 19.8585 21.3587C20.6069 20.6104 20.939 19.6614 21.0966 18.489C21.2498 17.3498 21.2498 15.8942 21.2498 14.0564V11.3115C21.9176 10.4718 22.235 9.35187 22.0034 8.19383L21.3838 5.0957C21.227 4.31024 21.1194 3.77127 20.8923 3.31853C20.4154 2.36798 19.5574 1.66458 18.5318 1.38342C18.0433 1.24951 17.4937 1.24969 16.6927 1.24996H7.30681ZM18.2682 12.75C18.7971 12.75 19.2969 12.6435 19.7498 12.4524V14C19.7498 15.9068 19.7482 17.2615 19.61 18.2891C19.4747 19.2952 19.2211 19.8749 18.7979 20.2981C18.3747 20.7213 17.795 20.975 16.7889 21.1102C16.3434 21.1701 15.8365 21.2044 15.2498 21.2239V18.4678C15.2498 18.028 15.2498 17.6486 15.2216 17.3373C15.1917 17.0082 15.1257 16.6822 14.9483 16.375C14.7508 16.0329 14.4668 15.7489 14.1248 15.5514C13.8176 15.3741 13.4916 15.308 13.1624 15.2782C12.8511 15.25 12.4718 15.25 12.032 15.25H11.9675C11.5278 15.25 11.1484 15.25 10.8371 15.2782C10.5079 15.308 10.182 15.3741 9.87477 15.5514C9.53272 15.7489 9.24869 16.0329 9.05121 16.375C8.87384 16.6822 8.80778 17.0082 8.77795 17.3373C8.74973 17.6486 8.74975 18.028 8.74977 18.4678L8.74977 21.2239C8.16304 21.2044 7.6561 21.1701 7.21062 21.1102C6.20453 20.975 5.62488 20.7213 5.20167 20.2981C4.77846 19.8749 4.52479 19.2952 4.38953 18.2891C4.25136 17.2615 4.24977 15.9068 4.24977 14V12.4523C4.70264 12.6435 5.20244 12.75 5.73132 12.75C7.00523 12.75 8.14422 12.1216 8.83783 11.1458C9.54734 12.1139 10.6929 12.75 11.9996 12.75C13.3063 12.75 14.452 12.1138 15.1615 11.1455C15.8551 12.1215 16.9942 12.75 18.2682 12.75ZM10.2498 21.248C10.6382 21.2499 11.0539 21.25 11.4998 21.25H12.4998C12.9457 21.25 13.3614 21.2499 13.7498 21.248V18.5C13.7498 18.0189 13.749 17.7082 13.7277 17.4727C13.7073 17.2476 13.6729 17.1659 13.6493 17.125C13.5835 17.011 13.4888 16.9163 13.3748 16.8505C13.3339 16.8269 13.2522 16.7925 13.027 16.772C12.7916 16.7507 12.4809 16.75 11.9998 16.75C11.5187 16.75 11.208 16.7507 10.9725 16.772C10.7474 16.7925 10.6656 16.8269 10.6248 16.8505C10.5108 16.9163 10.4161 17.011 10.3502 17.125C10.3267 17.1659 10.2922 17.2476 10.2718 17.4727C10.2505 17.7082 10.2498 18.0189 10.2498 18.5V21.248ZM8.67082 2.74999H7.41748C6.46302 2.74999 6.13246 2.75654 5.86433 2.83005C5.24897 2.99874 4.73416 3.42078 4.44806 3.99112C4.3234 4.23962 4.25214 4.56248 4.06496 5.4984L3.46703 8.48801C3.18126 9.91687 4.27415 11.25 5.73132 11.25C6.91763 11.25 7.91094 10.3511 8.02898 9.17063L8.09757 8.48474L8.10155 8.44273L8.67082 2.74999ZM9.59103 8.62499L10.1785 2.74999H13.8208L14.405 8.59198C14.5473 10.0151 13.4298 11.25 11.9996 11.25C10.5804 11.25 9.46911 10.0341 9.59103 8.62499ZM18.1352 2.83005C17.8671 2.75654 17.5365 2.74999 16.5821 2.74999H15.3285L15.9706 9.17063C16.0886 10.3511 17.0819 11.25 18.2682 11.25C19.7254 11.25 20.8183 9.91687 20.5325 8.48801L19.9346 5.4984C19.7474 4.56248 19.6762 4.23962 19.5515 3.99112C19.2654 3.42078 18.7506 2.99874 18.1352 2.83005Z" fill="currentColor"/>
                    </svg>
                    <span class="nav-text"><small>Business</small></span>
                </a>
                
                <a href="#" class="bottom-nav-item">
                    <svg width="30px" height="30px" stroke="currentColor" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17 17L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="nav-text"><small>Find Worker</small></span>
                </a>
                
                <a href="#" class="bottom-nav-item">
                    <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M20.9235 11.7502C20.9032 11.75 20.8766 11.75 20.8333 11.75H18.2308C16.8074 11.75 15.75 12.8087 15.75 14C15.75 15.1913 16.8074 16.25 18.2308 16.25H20.8333C20.8766 16.25 20.9032 16.25 20.9235 16.2498C20.9427 16.2496 20.948 16.2492 20.948 16.2492C21.154 16.2367 21.2427 16.0976 21.2495 16.0139C21.2495 16.0139 21.2497 16.0077 21.2498 15.9986C21.25 15.9808 21.25 15.9572 21.25 15.9167V12.0833C21.25 12.0609 21.25 12.0437 21.25 12.0297C21.2499 12.0185 21.2499 12.0093 21.2498 12.0014C21.2497 11.9924 21.2495 11.9861 21.2495 11.9861C21.2427 11.9024 21.154 11.7633 20.9479 11.7508C20.9479 11.7508 20.943 11.7504 20.9235 11.7502ZM20.8499 10.25C20.9163 10.25 20.9803 10.2499 21.0391 10.2535C21.9104 10.3066 22.681 10.9638 22.7458 11.8818C22.7501 11.942 22.75 12.0069 22.75 12.067C22.75 12.0725 22.75 12.0779 22.75 12.0833V15.9167C22.75 15.9221 22.75 15.9275 22.75 15.933C22.75 15.9931 22.7501 16.058 22.7458 16.1182C22.681 17.0362 21.9104 17.6934 21.0391 17.7465C20.9803 17.7501 20.9163 17.75 20.8499 17.75C20.8444 17.75 20.8389 17.75 20.8333 17.75H18.2308C16.0856 17.75 14.25 16.1224 14.25 14C14.25 11.8776 16.0856 10.25 18.2308 10.25H20.8333C20.8389 10.25 20.8444 10.25 20.8499 10.25Z" fill="currentColor"/>
                        <path d="M19 14C19 14.5523 18.5523 15 18 15C17.4477 15 17 14.5523 17 14C17 13.4477 17.4477 13 18 13C18.5523 13 19 13.4477 19 14Z" fill="currentColor"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M20.8499 10.25C20.9163 10.25 20.9803 10.2499 21.0391 10.2535C21.2645 10.2672 21.4832 10.3214 21.6847 10.4101C21.5777 8.80363 21.2831 7.56563 20.3588 6.64124C19.6104 5.89288 18.6614 5.56076 17.489 5.40313L17.4467 5.39754C17.4362 5.38977 17.4255 5.38223 17.4145 5.37492L13.679 2.89806C12.3758 2.03398 10.6242 2.03398 9.32102 2.89806L5.58554 5.37492C5.57453 5.38223 5.56377 5.38977 5.55327 5.39754L5.51098 5.40313C4.33856 5.56076 3.38961 5.89288 2.64124 6.64124C1.89288 7.38961 1.56076 8.33856 1.40314 9.51098C1.24997 10.6502 1.24998 12.1058 1.25 13.9436V14.0564C1.24998 15.8942 1.24997 17.3498 1.40314 18.489C1.56076 19.6614 1.89288 20.6104 2.64124 21.3588C3.38961 22.1071 4.33856 22.4392 5.51098 22.5969C6.65019 22.75 8.10583 22.75 9.94359 22.75H13.0564C14.8942 22.75 16.3498 22.75 17.489 22.5969C18.6614 22.4392 19.6104 22.1071 20.3588 21.3588C21.2831 20.4344 21.5777 19.1964 21.6847 17.5899C21.4832 17.6786 21.2645 17.7328 21.0391 17.7465C20.9803 17.7501 20.9163 17.75 20.8499 17.75L20.8333 17.75H20.1679C20.0541 19.0915 19.7966 19.7996 19.2981 20.2981C18.8749 20.7213 18.2952 20.975 17.2892 21.1102C16.2615 21.2484 14.9068 21.25 13 21.25H10C8.09318 21.25 6.73851 21.2484 5.71085 21.1102C4.70476 20.975 4.12511 20.7213 3.7019 20.2981C3.27869 19.8749 3.02502 19.2952 2.88976 18.2892C2.75159 17.2615 2.75 15.9068 2.75 14C2.75 12.0932 2.75159 10.7385 2.88976 9.71085C3.02502 8.70476 3.27869 8.12511 3.7019 7.7019C4.12511 7.27869 4.70476 7.02502 5.71085 6.88976C6.73851 6.75159 8.09318 6.75 10 6.75H13C14.9068 6.75 16.2615 6.75159 17.2892 6.88976C18.2952 7.02502 18.8749 7.27869 19.2981 7.7019C19.7966 8.20043 20.0541 8.90854 20.1679 10.25H20.8333L20.8499 10.25ZM9.94358 5.25H13.0564C13.5729 5.24999 14.0592 5.24999 14.5168 5.25339L12.8501 4.14821C12.0493 3.61726 10.9507 3.61726 10.15 4.14821L8.48318 5.25339C8.94077 5.24999 9.42708 5.24999 9.94358 5.25Z" fill="currentColor"/>
                        <path d="M6 9.25C5.58579 9.25 5.25 9.58579 5.25 10C5.25 10.4142 5.58579 10.75 6 10.75H10C10.4142 10.75 10.75 10.4142 10.75 10C10.75 9.58579 10.4142 9.25 10 9.25H6Z" fill="currentColor"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M19 14C19 14.5523 18.5523 15 18 15C17.4477 15 17 14.5523 17 14C17 13.4477 17.4477 13 18 13C18.5523 13 19 13.4477 19 14Z" fill="currentColor"/>
                    </svg>
                    <span class="nav-text"><small>Wallet</small></span>
                </a>
                
                <a href="#" class="bottom-nav-item">
                    <svg width="30px" height="30px" viewBox="0 -19.5 164 164" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.2329 89.0831C17.3341 89.4211 15.7432 89.7559 14.1371 89.9817C7.06966 90.976 1.51901 86.5687 0.48068 79.5288C-1.0289 69.307 6.73229 58.1139 14.141 55.0389C16.6482 53.9986 19.5794 53.9795 23.0364 53.3665C32.2494 32.1615 49.7618 21.7934 73.5423 20.3488C73.8921 16.4462 74.238 12.5935 74.6022 8.54059C73.5751 8.11988 72.3431 7.95977 71.6796 7.26077C70.7134 6.24344 69.5996 4.84016 69.5957 3.59771C69.5918 2.53116 70.9221 0.709891 71.8974 0.535306C74.597 0.0535535 77.542 -0.276629 80.1608 0.325233C83.5048 1.0938 83.9852 3.75262 81.8548 6.48561C81.4171 6.9389 81.1341 7.51899 81.0462 8.14288C81.224 11.6156 81.5273 15.081 81.7616 18.179C88.0211 18.7375 94.0055 19.0381 99.9211 19.8421C119.273 22.472 132.088 33.3508 139.077 51.3896C139.194 51.6909 139.333 51.9849 139.478 52.2744C139.549 52.3747 139.633 52.4656 139.727 52.5448C142.943 52.5448 146.247 52.1103 149.393 52.6347C156.138 53.7583 161.178 57.4004 162.853 64.3477C164.528 71.2951 161.862 77.0616 156.759 81.6435C151.742 86.1493 145.621 87.389 138.993 86.5404C138.746 86.7453 138.532 86.987 138.359 87.2571C130.949 104.691 117.203 114.915 99.7662 120.658C84.6227 125.684 68.3154 126.026 52.9746 121.639C36.0424 116.958 23.8017 107.182 19.2329 89.0831ZM74.3653 116.033C77.9548 115.728 81.5686 115.59 85.1292 115.09C99.4118 113.083 112.05 107.628 121.744 96.6153C138.759 77.2881 134.524 42.1123 104.846 32.3558C93.8566 28.746 82.3857 26.5243 70.7233 27.2725C57.6687 28.1106 46.2832 33.0968 37.8617 43.4256C30.0513 53.0022 26.6062 64.3694 26.3233 76.5471C25.9125 94.2223 34.5276 106.232 51.1808 112.095C58.6448 114.649 66.4731 115.979 74.362 116.032L74.3653 116.033ZM20.0205 60.3756C19.7421 60.3376 19.4597 60.3412 19.1824 60.3861C12.7641 62.2757 6.45466 73.2929 8.09026 79.6823C8.58579 81.6199 9.81316 82.7712 11.7592 82.8092C13.8765 82.8512 16.0005 82.5894 17.5501 82.4949C18.4092 74.7881 19.2099 67.6156 20.0185 60.3742L20.0205 60.3756ZM141.736 77.21C145.278 77.15 148.678 75.8064 151.305 73.4289C154.874 70.1905 155.296 65.2817 152.224 62.4522C149.242 59.7061 145.667 58.9152 141.736 59.7146V77.21Z" fill="currentColor"/>
                        <path d="M84.8075 82.0252C86.4018 82.3193 88.1725 82.2825 89.5331 83.0097C90.1516 83.3495 90.6946 83.8115 91.129 84.3676C91.5634 84.9238 91.8802 85.5624 92.06 86.2448C92.3344 88.1095 90.7172 89.0671 88.9411 89.2994C88.0814 89.4143 87.2076 89.3635 86.367 89.1498C84.8505 88.6937 83.2428 88.6309 81.6954 88.9674C80.148 89.304 78.7116 90.0287 77.5215 91.0734C76.1714 92.182 74.5896 93.0209 73.233 91.3781C72.0319 89.9236 72.5832 88.2348 73.7817 86.9346C75.1549 85.3673 76.8518 84.1166 78.7554 83.269C80.659 82.4214 82.7239 81.9971 84.8075 82.0252Z" fill="currentColor"/>
                        <path d="M57.7186 52.5112C61.4295 52.6392 63.7503 55.2876 63.5495 59.1645C63.3893 62.2533 60.9084 64.7434 58.1203 64.6154C54.9698 64.4703 52.4724 61.3206 52.607 57.6582C52.7442 53.9453 54.2853 52.3924 57.7186 52.5112Z" fill="currentColor"/>
                        <path d="M93.575 57.3327C93.5684 54.2361 94.7564 52.8328 97.4244 52.7856C100.873 52.7245 103.039 54.689 102.96 57.8066C102.891 60.4916 100.78 62.7678 98.3 62.8282C95.4672 62.8971 93.5822 60.7024 93.575 57.3327Z" fill="currentColor"/>
                    </svg>
                    <span class="nav-text"><small>Chat AI</small></span>
                </a>
                
                <a href="#" class="bottom-nav-item active">
                    <svg fill="none" width="30px" height="30px" viewBox="0 0 24 24" id="menu" xmlns="http://www.w3.org/2000/svg" class="icon multi-color">
                        <line id="primary-stroke" x1="3" y1="12" x2="21" y2="12" style="fill: none; stroke: currentColor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></line>
                        <path id="primary-stroke-2" data-name="primary-stroke" d="M9,18H21M3,6H15" style="fill: none; stroke: currentColor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></path>
                    </svg>
                    <span class="nav-text"><small>Feeds</small></span>
                </a>
            </div>
        </div>
    </nav>

    <script>
        // Configuration
        const API_URL = 'https://video-reels.helparr.com/api/videos';
        const VIDEOS_BASE_URL = 'https://video-reels.helparr.com/api/videos';
        const CONTROLS_FADE_TIME = 2000; // 2 seconds
        const NAV_HIDE_TIME = 2000; // 2 seconds to hide nav

        // Fix for browser toolbar zoom issue on mobile
        // This prevents content from zooming/shifting when browser chrome appears/disappears
        function fixViewportHeight() {
            const viewport = document.querySelector('meta[name="viewport"]');
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            window.addEventListener('resize', () => {
                vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            });

            // Prevent zoom on input focus
            document.addEventListener('touchstart', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {
                    e.target.style.fontSize = '16px';
                }
            }, { passive: true });
        }

        fixViewportHeight();

        // Close button functionality
        const closeBtn = document.getElementById('closeBtn');
        closeBtn.addEventListener('click', () => {
            window.history.back();
        });

        // Video players manager
        let videoPlayers = {};
        let currentlyPlayingVideo = null;
        let observer = null;
        let navHideTimeout = null;

        // Nav hide functionality
        const navContent = document.getElementById('navContent');
        const bottomNav = document.getElementById('bottomNav');
        const progressBarTop = document.getElementById('progressBarTop');
        const progressBarBottom = document.getElementById('progressBarBottom');

        function showNav() {
            navContent.classList.remove('hidden');
            progressBarTop.classList.remove('hidden');
            progressBarBottom.classList.add('hidden');
            
            // Clear existing timeout
            if (navHideTimeout) {
                clearTimeout(navHideTimeout);
            }
            
            // Auto-hide after 2 seconds
            navHideTimeout = setTimeout(() => {
                hideNav();
            }, NAV_HIDE_TIME);
        }

        function hideNav() {
            navContent.classList.add('hidden');
            progressBarTop.classList.add('hidden');
            progressBarBottom.classList.remove('hidden');
            if (navHideTimeout) {
                clearTimeout(navHideTimeout);
            }
        }

        // Show nav on any interaction
        bottomNav.addEventListener('click', showNav);
        document.addEventListener('touchstart', showNav);
        
        // Show nav on scroll
        document.getElementById('videosContainer').addEventListener('scroll', showNav);

        // Initial show
        showNav();

        // Format time helper
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // Create video element HTML
        function createVideoElement(video, index) {
            const videoId = video.id;
            const videoUrl = `${VIDEOS_BASE_URL}/${videoId}/stream`;
            const videoDuration = video.metadata?.format?.duration 
                ? parseFloat(video.metadata.format.duration) 
                : 0;
            
            const videoStream = video.metadata?.streams?.find(s => s.codec_type === 'video');
            const width = videoStream?.width || 720;
            const height = videoStream?.height || 1080;
            const duration = formatTime(videoDuration);

            return `
                <div class="video-feed-container">
                    <div class="video-wrapper">
                        <video 
                            id="videoPlayer${index}" 
                            data-video-id="${videoId}"
                            playsinline
                            webkit-playsinline
                            x5-playsinline
                            preload="metadata">
                            <source src="${videoUrl}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>

                        <!-- Loading Indicator -->
                        <div class="loading-indicator" id="loadingIndicator${index}">
                            <div class="spinner-ring"></div>
                        </div>

                        <!-- Tap zone to show/toggle controls -->
                        <div class="tap-zone" id="tapZone${index}"></div>

                        <!-- Header Overlay -->
                        <div class="header-overlay" id="headerOverlay${index}">
                            <div class="avatar"></div>
                            <div class="creator-info">
                                <div class="creator-name">HELPARR Creator</div>
                                <div class="creator-time">${duration}</div>
                            </div>
                        </div>

                        <!-- Engagement Overlay -->
                        <div class="engagement-overlay" id="engagementOverlay${index}">
                            <div class="top-right-section">
                                <div class="views-badge">
                                    <div class="badge">
                                        <svg fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
                                            <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span class="badge-text">${Math.floor(Math.random() * 2000)}K</span>
                                    </div>
                                </div>

                                <div class="mute-button-wrapper">
                                    <button class="mute-btn-small" id="muteBtn${index}">
                                        <svg fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 2h4a1 1 0 011 1v12a1 1 0 01-1 1h-4a1 1 0 01-.617-.176l-5.061-3.82A1 1 0 003 9.2V6.8a1 1 0 01.617-.924l5.061-3.82zm-5 5.824a1 1 0 001.414 0l2.121-2.121a1 1 0 10-1.414-1.414L5.293 7.293a1 1 0 000 1.414z" clip-rule="evenodd"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <div class="engagement-buttons">
                                <button class="engagement-btn">
                                    <svg width="50px" height="50px" viewBox="0 0 24 24" fill="none" stroke="#fff" xmlns="http://www.w3.org/2000/svg" style="opacity: 1;">
                            <path opacity="1" d="M12 5.50098L14 7.5004" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M8.96173 18.9109L9.42605 18.3219L8.96173 18.9109ZM12 5.50063L11.4596 6.02073C11.601 6.16763 11.7961 6.25063 12 6.25063C12.2039 6.25063 12.399 6.16763 12.5404 6.02073L12 5.50063ZM15.0383 18.9109L15.5026 19.4999L15.0383 18.9109ZM9.42605 18.3219C7.91039 17.1271 6.25307 15.9603 4.93829 14.4798C3.64922 13.0282 2.75 11.3345 2.75 9.1371H1.25C1.25 11.8026 2.3605 13.8361 3.81672 15.4758C5.24723 17.0866 7.07077 18.3752 8.49742 19.4999L9.42605 18.3219ZM2.75 9.1371C2.75 6.98623 3.96537 5.18252 5.62436 4.42419C7.23607 3.68748 9.40166 3.88258 11.4596 6.02073L12.5404 4.98053C10.0985 2.44352 7.26409 2.02539 5.00076 3.05996C2.78471 4.07292 1.25 6.42503 1.25 9.1371H2.75ZM8.49742 19.4999C9.00965 19.9037 9.55954 20.3343 10.1168 20.6599C10.6739 20.9854 11.3096 21.25 12 21.25V19.75C11.6904 19.75 11.3261 19.6293 10.8736 19.3648C10.4213 19.1005 9.95208 18.7366 9.42605 18.3219L8.49742 19.4999ZM15.5026 19.4999C16.9292 18.3752 18.7528 17.0866 20.1833 15.4758C21.6395 13.8361 22.75 11.8026 22.75 9.1371H21.25C21.25 11.3345 20.3508 13.0282 19.0617 14.4798C17.7469 15.9603 16.0896 17.1271 14.574 18.3219L15.5026 19.4999ZM22.75 9.1371C22.75 6.42503 21.2153 4.07292 18.9992 3.05996C16.7359 2.02539 13.9015 2.44352 11.4596 4.98053L12.5404 6.02073C14.5983 3.88258 16.7639 3.68748 18.3756 4.42419C20.0346 5.18252 21.25 6.98623 21.25 9.1371H22.75ZM14.574 18.3219C14.0479 18.7366 13.5787 19.1005 13.1264 19.3648C12.6739 19.6293 12.3096 19.75 12 19.75V21.25C12.6904 21.25 13.3261 20.9854 13.8832 20.6599C14.4405 20.3343 14.9903 19.9037 15.5026 19.4999L14.574 18.3219Z" fill="#fff"/>
                        </svg>
                                    <span>${Math.floor(Math.random() * 1000)}K</span>
                                </button>

                                <button class="engagement-btn">
                                    <svg width="40px" height="40px" stroke="currentColor" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 14.6C3 14.0399 3 13.7599 3.10899 13.546C3.20487 13.3578 3.35785 13.2049 3.54601 13.109C3.75992 13 4.03995 13 4.6 13H5.4C5.96005 13 6.24008 13 6.45399 13.109C6.64215 13.2049 6.79513 13.3578 6.89101 13.546C7 13.7599 7 14.0399 7 14.6V19.4C7 19.9601 7 20.2401 6.89101 20.454C6.79513 20.6422 6.64215 20.7951 6.45399 20.891C6.24008 21 5.96005 21 5.4 21H4.6C4.03995 21 3.75992 21 3.54601 20.891C3.35785 20.7951 3.20487 20.6422 3.10899 20.454C3 20.2401 3 19.9601 3 19.4V14.6Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10 4.6C10 4.03995 10 3.75992 10.109 3.54601C10.2049 3.35785 10.3578 3.20487 10.546 3.10899C10.7599 3 11.0399 3 11.6 3H12.4C12.9601 3 13.2401 3 13.454 3.10899C13.6422 3.20487 13.7951 3.35785 13.891 3.54601C14 3.75992 14 4.03995 14 4.6V19.4C14 19.9601 14 20.2401 13.891 20.454C13.7951 20.6422 13.6422 20.7951 13.454 20.891C13.2401 21 12.9601 21 12.4 21H11.6C11.0399 21 10.7599 21 10.546 20.891C10.3578 20.7951 10.2049 20.6422 10.109 20.454C10 20.2401 10 19.9601 10 19.4V4.6Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M17 10.6C17 10.0399 17 9.75992 17.109 9.54601C17.2049 9.35785 17.3578 9.20487 17.546 9.10899C17.7599 9 18.0399 9 18.6 9H19.4C19.9601 9 20.2401 9 20.454 9.10899C20.6422 9.20487 20.7951 9.35785 20.891 9.54601C21 9.75992 21 10.0399 21 10.6V19.4C21 19.9601 21 20.2401 20.891 20.454C20.7951 20.6422 20.6422 20.7951 20.454 20.891C20.2401 21 19.9601 21 19.4 21H18.6C18.0399 21 17.7599 21 17.546 20.891C17.3578 20.7951 17.2049 20.6422 17.109 20.454C17 20.2401 17 19.9601 17 19.4V10.6Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
                                    <span>${Math.floor(Math.random() * 500)}K</span>
                                </button>

                                <button class="engagement-btn">
                                    <svg width="40px" height="40px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9 12C9 13.3807 7.88071 14.5 6.5 14.5C5.11929 14.5 4 13.3807 4 12C4 10.6193 5.11929 9.5 6.5 9.5C7.88071 9.5 9 10.6193 9 12Z" stroke="#fff" stroke-width="1.5"/>
<path d="M14 6.5L9 10" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
<path d="M14 17.5L9 14" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
<path d="M19 18.5C19 19.8807 17.8807 21 16.5 21C15.1193 21 14 19.8807 14 18.5C14 17.1193 15.1193 16 16.5 16C17.8807 16 19 17.1193 19 18.5Z" stroke="#fff" stroke-width="1.5"/>
<path d="M19 5.5C19 6.88071 17.8807 8 16.5 8C15.1193 8 14 6.88071 14 5.5C14 4.11929 15.1193 3 16.5 3C17.8807 3 19 4.11929 19 5.5Z" stroke="#fff" stroke-width="1.5"/>
</svg>
                                    <span>${Math.floor(Math.random() * 200)}K</span>
                                </button>
                            </div>
                        </div>

                        <!-- Play Button Overlay - Center of screen -->
                        <div class="play-overlay" id="playOverlay${index}">
                            <button class="play-button" id="playBtn${index}">
                                <svg fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"></path>
                                </svg>
                            </button>
                        </div>

                        <!-- Controls Overlay -->
                        <div class="controls-overlay" id="controlsOverlay${index}">
                            <div class="progress-container">
                                <div class="progress-bar" id="progressBar${index}">
                                    <div class="progress-fill" id="progressFill${index}">
                                        <div class="progress-thumb"></div>
                                    </div>
                                </div>
                                <span class="time-display" id="timeDisplay${index}">0:00 / ${duration}</span>
                            </div>

                            <div class="control-buttons">
                                <button class="control-btn" id="playPauseBtn${index}">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </button>

                                <div></div>

                                <button class="control-btn" id="fullscreenBtn${index}">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4m-4 0l5 5m11-5v4m0-4h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize video player
        function initializeVideoPlayer(num, isFirstVideo = false) {
            const video = document.getElementById(`videoPlayer${num}`);
            if (!video) return null;

            const loadingIndicator = document.getElementById(`loadingIndicator${num}`);
            const tapZone = document.getElementById(`tapZone${num}`);
            const playOverlay = document.getElementById(`playOverlay${num}`);
            const playBtn = document.getElementById(`playBtn${num}`);
            const muteBtn = document.getElementById(`muteBtn${num}`);
            const progressBar = document.getElementById(`progressBar${num}`);
            const progressFill = document.getElementById(`progressFill${num}`);
            const timeDisplay = document.getElementById(`timeDisplay${num}`);
            const controlsOverlay = document.getElementById(`controlsOverlay${num}`);
            const headerOverlay = document.getElementById(`headerOverlay${num}`);
            const engagementOverlay = document.getElementById(`engagementOverlay${num}`);

            let isPlaying = false;
            let isDragging = false;
            let manualPause = false;
            let controlsVisible = false;
            let controlsFadeTimeout = null;
            let autoplayAttempted = false;

            // Show loading indicator
            function showLoading() {
                loadingIndicator.classList.add('visible');
            }

            // Hide loading indicator
            function hideLoading() {
                loadingIndicator.classList.remove('visible');
            }

            // Show controls and set auto-hide timer (only for controls overlay, not header/engagement)
            function showControls() {
                controlsVisible = true;
                controlsOverlay.classList.add('visible');
                // Header and engagement overlay always visible - no need to show/hide
                headerOverlay.classList.remove('hidden');
                engagementOverlay.classList.remove('hidden');

                if (controlsFadeTimeout) {
                    clearTimeout(controlsFadeTimeout);
                }

                // Only hide the controls overlay (progress bar), not header/engagement buttons
                if (isPlaying) {
                    controlsFadeTimeout = setTimeout(() => {
                        hideControls();
                    }, CONTROLS_FADE_TIME);
                }
            }

            // Hide controls (but keep header and engagement overlay always visible)
            function hideControls() {
                controlsVisible = false;
                controlsOverlay.classList.remove('visible');
                // Header and engagement overlay now ALWAYS stay visible
                // headerOverlay.classList.add('hidden'); - REMOVED
                // engagementOverlay.classList.add('hidden'); - REMOVED
            }

            function autoPlayVideo() {

                if (video.currentTime > 0) {
        video.currentTime = 0;
    }
                if (!manualPause && !isPlaying && !autoplayAttempted) {
                    autoplayAttempted = true;
                    showLoading();
                    
                    video.muted = true;
                    
                    setTimeout(() => {
                        console.log('Attempting autoplay for video ' + num);
                        const playPromise = video.play();
                        if (playPromise !== undefined) {
                            playPromise
                                .then(() => {
                                    console.log('Autoplay succeeded for video ' + num);
                                    isPlaying = true;
                                    manualPause = false;
                                    playOverlay.classList.remove('visible');
                                    showControls();
                                    hideLoading();
                                    video.muted = false;
                                    updateUI();

                                    if (controlsFadeTimeout) {
                                        clearTimeout(controlsFadeTimeout);
                                    }
                                    controlsFadeTimeout = setTimeout(() => {
                                        hideControls();
                                    }, CONTROLS_FADE_TIME);
                                })
                                .catch((error) => {
                                    console.log('Autoplay failed for video ' + num + ':', error.name);
                                    autoplayAttempted = false;
                                    isPlaying = false;
                                    hideLoading();
                                    playOverlay.classList.add('visible');
                                    
                                    if (error.name === 'NotAllowedError') {
                                        console.log('Autoplay blocked by browser policy');
                                        video.muted = true;
                                    }
                                });
                        }
                    }, 100);
                }
            }

          function pauseVideo() {
    video.pause();
    isPlaying = false;
    manualPause = false;
    autoplayAttempted = false;  //  RESET FLAG
    hideControls();
    hideLoading();
    updateUI();
}

            function togglePlayPause() {
                if (isPlaying) {
                    video.pause();
                    isPlaying = false;
                    manualPause = true;
                    playOverlay.classList.add('visible');
                    showControls();
                    hideLoading();
                } else {
                    showLoading();
                    video.play()
                        .then(() => {
                            isPlaying = true;
                            manualPause = false;
                            playOverlay.classList.remove('visible');
                            showControls();
                            hideLoading();

                            if (controlsFadeTimeout) {
                                clearTimeout(controlsFadeTimeout);
                            }
                            controlsFadeTimeout = setTimeout(() => {
                                hideControls();
                            }, CONTROLS_FADE_TIME);
                        })
                        .catch(e => {
                            console.log('Play failed:', e);
                            hideLoading();
                        });
                }
                updatePlayPauseIcon();
            }

            function updatePlayPauseIcon() {
                if (isPlaying) {
                    playBtn.innerHTML = `<svg fill="currentColor" viewBox="0 0 20 20"><path d="M6 4a2 2 0 012-2h4a2 2 0 012 2v12a2 2 0 01-2 2H8a2 2 0 01-2-2V4z"></path></svg>`;
                } else {
                    playBtn.innerHTML = `<svg fill="currentColor" viewBox="0 0 20 20"><path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"></path></svg>`;
                }
            }

            function updateMuteIcon() {
                if (video.muted) {
                    muteBtn.innerHTML = `<svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-14-14zM6.54 5.726A1 1 0 006 6.8v6.4a1 1 0 001.556.832l3.353-2.233 2.872 2.87a1 1 0 101.416-1.414L10.002 12l3.195-3.195a1 1 0 10-1.414-1.414l-2.872 2.87-3.353-2.232zM13 2h4a1 1 0 011 1v12a1 1 0 01-1 1h-4a1 1 0 01-.617-.176.617.176.617-.176.617.176A1 1 0 0113 15V3a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>`;
                } else {
                    muteBtn.innerHTML = `<svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 2h4a1 1 0 011 1v12a1 1 0 01-1 1h-4a1 1 0 01-.617-.176l-5.061-3.82A1 1 0 003 9.2V6.8a1 1 0 01.617-.924l5.061-3.82zm-5 5.824a1 1 0 001.414 0l2.121-2.121a1 1 0 10-1.414-1.414L5.293 7.293a1 1 0 000 1.414z" clip-rule="evenodd"></path></svg>`;
                }
            }

            video.addEventListener('loadstart', () => {
                showLoading();
            });

            video.addEventListener('canplay', () => {
                hideLoading();
            });

            video.addEventListener('waiting', () => {
                showLoading();
            });

            video.addEventListener('playing', () => {
                hideLoading();
            });

            video.addEventListener('timeupdate', () => {
                if (!isDragging) {
                    const percent = (video.currentTime / video.duration) * 100;
                    progressFill.style.width = percent + '%';
                    timeDisplay.textContent = `${formatTime(video.currentTime)} / ${formatTime(video.duration)}`;
                    
                    // Update nav progress bars
                    const navProgressFillTop = document.getElementById('navProgressFillTop');
                    const navProgressFillBottom = document.getElementById('navProgressFillBottom');
                    if (navProgressFillTop) {
                        navProgressFillTop.style.width = percent + '%';
                    }
                    if (navProgressFillBottom) {
                        navProgressFillBottom.style.width = percent + '%';
                    }
                }
            });

            video.addEventListener('play', () => {
                isPlaying = true;
                updatePlayPauseIcon();
            });

            video.addEventListener('pause', () => {
                isPlaying = false;
                updatePlayPauseIcon();
            });

            tapZone.addEventListener('click', (e) => {
                e.preventDefault();
                if (controlsVisible) {
                    togglePlayPause();
                } else {
                    showControls();
                }
            });

            tapZone.addEventListener('touchend', (e) => {
                e.preventDefault();
                if (controlsVisible) {
                    togglePlayPause();
                } else {
                    showControls();
                }
            });

            progressBar.addEventListener('mousedown', () => {
                isDragging = true;
            });

            progressBar.addEventListener('touchstart', (e) => {
                isDragging = true;
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });

            document.addEventListener('touchend', () => {
                isDragging = false;
            });

            progressBar.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const rect = progressBar.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                const newTime = percent * video.duration;
                video.currentTime = Math.max(0, Math.min(newTime, video.duration));
            });

            progressBar.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                const touch = e.touches[0];
                const rect = progressBar.getBoundingClientRect();
                const percent = (touch.clientX - rect.left) / rect.width;
                const newTime = percent * video.duration;
                video.currentTime = Math.max(0, Math.min(newTime, video.duration));
            });

            progressBar.addEventListener('click', (e) => {
                const rect = progressBar.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                const newTime = percent * video.duration;
                video.currentTime = Math.max(0, Math.min(newTime, video.duration));
            });

            progressBar.addEventListener('touchend', (e) => {
                const touch = e.changedTouches[0];
                const rect = progressBar.getBoundingClientRect();
                const percent = (touch.clientX - rect.left) / rect.width;
                const newTime = percent * video.duration;
                video.currentTime = Math.max(0, Math.min(newTime, video.duration));
            });

            // Nav progress bar click
            const progressBarTopElem = document.getElementById('progressBarTop');
            const progressBarBottomElem = document.getElementById('progressBarBottom');
            
            if (progressBarTopElem) {
                progressBarTopElem.addEventListener('click', (e) => {
                    if (!video.duration) return;
                    const rect = progressBarTopElem.getBoundingClientRect();
                    const percent = (e.clientX - rect.left) / rect.width;
                    const newTime = percent * video.duration;
                    video.currentTime = Math.max(0, Math.min(newTime, video.duration));
                });
            }

            if (progressBarBottomElem) {
                progressBarBottomElem.addEventListener('click', (e) => {
                    if (!video.duration) return;
                    const rect = progressBarBottomElem.getBoundingClientRect();
                    const percent = (e.clientX - rect.left) / rect.width;
                    const newTime = percent * video.duration;
                    video.currentTime = Math.max(0, Math.min(newTime, video.duration));
                });
            }

            video.addEventListener('ended', () => {
                isPlaying = false;
                playOverlay.classList.add('visible');
                showControls();
                hideLoading();
                updatePlayPauseIcon();

                const nextVideoNum = num + 1;
                const nextVideoContainer = document.querySelector(`.video-feed-container:has(#videoPlayer${nextVideoNum})`);
                if (nextVideoContainer) {
                    setTimeout(() => {
                        nextVideoContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                }
            });

            video.addEventListener('loadedmetadata', () => {
                timeDisplay.textContent = `0:00 / ${formatTime(video.duration)}`;
            });

            function updateUI() {
                updatePlayPauseIcon();
                updateMuteIcon();
            }

            playBtn.addEventListener('click', togglePlayPause);
            muteBtn.addEventListener('click', () => {
                video.muted = !video.muted;
                updateMuteIcon();
            });

            if (observer) {
                observer.observe(video);
            }

            return {
                autoPlayVideo,
                pauseVideo
            };
        }

        // Setup intersection observer
       function setupObserver() {
    observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            const videoNum = entry.target.id.replace('videoPlayer', '');
            const player = videoPlayers[videoNum];

            if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                if (currentlyPlayingVideo !== null && currentlyPlayingVideo !== videoNum) {
                    const previousPlayer = videoPlayers[currentlyPlayingVideo];
                    if (previousPlayer) {
                        previousPlayer.pauseVideo();
                    }
                }

                currentlyPlayingVideo = videoNum;
                if (player) {
                    //  RESET AUTOPLAY FLAG SO VIDEO RESTARTS FROM BEGINNING
                    player.autoplayAttempted = false;
                    player.manualPause = false;
                    player.autoPlayVideo();
                }
            } else {
                if (currentlyPlayingVideo === videoNum && player) {
                    player.pauseVideo();
                    currentlyPlayingVideo = null;
                }
            }
        });
    }, {
        threshold: [0.5]
    });
}

        // Fetch and render videos
        async function loadVideos() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const videos = data.videos || [];

                if (videos.length === 0) {
                    document.getElementById('videosContainer').innerHTML = '<div class="error">No videos found</div>';
                    return;
                }

                setupObserver();

                let html = '';
                videos.forEach((video, index) => {
                    html += createVideoElement(video, index + 1);
                });

                document.getElementById('videosContainer').innerHTML = html;

                videos.forEach((_, index) => {
                    videoPlayers[index + 1] = initializeVideoPlayer(index + 1, index === 0);
                });

            } catch (error) {
                console.error('Error loading videos:', error);
                document.getElementById('videosContainer').innerHTML = `
                    <div class="error">
                        <div>
                            <p>Failed to load videos</p>
                            <p style="font-size: 0.9rem; margin-top: 1rem; color: #aaa;">Error: ${error.message}</p>
                        </div>
                    </div>
                `;
            }
        }

        // Load videos when page loads
        window.addEventListener('DOMContentLoaded', loadVideos);
    </script>
</body>
</html>